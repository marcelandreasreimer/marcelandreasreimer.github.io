<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chaotic Lines VJ Generator (Crazier Presets)</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: black;
        }
        canvas {
            display: block;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.7/dat.gui.min.js"></script>
</head>
<body>
    <canvas id="vjCanvas"></canvas>

    <script>
        // --- 1. SETUP CANVAS AND CONTEXT ---
        const canvas = document.getElementById('vjCanvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        let animationTime = 0; // Tracks time for motion

        // Function to resize the canvas to fill the window
        function resizeCanvas() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        }
        window.addEventListener('resize', () => {
            resizeCanvas();
            initializeLines(); // Re-initialize lines on resize
        });
        resizeCanvas();

        // --- 2. STYLE PRESETS AND GUI PARAMETERS ---
        const STYLE_PRESETS = {
            'Monochrome': {
                mode: 'Monochrome',
                colors: ['#FFFFFF', '#DDDDDD', '#BBBBBB'], // Gray scale for monochrome
            },
            'High-Contrast Neon': {
                mode: 'Fixed',
                colors: ['#00FFFF', '#FF0055', '#FFFF00', '#0000FF'],
            },
            // Crazier Warm Vintage Colors
            'Warm Vintage': {
                mode: 'Fixed',
                colors: ['#FF4400', '#FFBB00', '#CC00FF', '#FF88DD', '#AA00FF'], // More intense oranges, added fuchsia/purple
            },
            // Crazier Toxic Green Colors
            'Toxic Green': {
                mode: 'Fixed',
                colors: ['#00FF00', '#00DD22', '#CCFF00', '#00EEFF', '#88FF00'], // Brighter greens, added lime and aqua
            },
             'Psychedelic Rainbow': {
                mode: 'Fixed',
                colors: ['#FF0000', '#FF8800', '#FFFF00', '#00FF00', '#0000FF', '#8800FF', '#FF00FF'],
            },
        };

        const GUI_PARAMS = {
            numLines: 500,
            baseSpeed: 1,
            maxLineWidth: 8,
            motionIntensity: 2,
            
            stylePreset: 'High-Contrast Neon', 
            
            fadeBackground: false,
            fadeAlpha: 0.1,
            init: initializeLines
        };

        // --- 3. HELPER FUNCTIONS ---
        const randomRange = (min, max) => Math.random() * (max - min) + min;
        
        // Function to select a random color from the current preset's array
        const generateStrokeColor = (presetKey) => {
            const preset = STYLE_PRESETS[presetKey];

            if (preset.mode === 'Monochrome') {
                const brightness = Math.random() * 100;
                return `hsl(0, 0%, ${brightness}%)`; 
            } else {
                return preset.colors[Math.floor(Math.random() * preset.colors.length)];
            }
        };

        // --- 4. LINE DATA STRUCTURE AND INITIALIZATION ---
        let lines = [];

        function createLine() {
            return {
                x1: randomRange(0, width),
                y1: randomRange(0, height),
                x2: randomRange(0, width),
                y2: randomRange(0, height),
                
                speedX1: randomRange(-5, 5), 
                speedY1: randomRange(-5, 5),
                speedX2: randomRange(-5, 5),
                speedY2: randomRange(-5, 5),
                lineWidth: randomRange(1, GUI_PARAMS.maxLineWidth),
                strokeColor: generateStrokeColor(GUI_PARAMS.stylePreset),
            };
        }

        // Handles creation and regeneration of lines
        function initializeLines() {
            lines = Array.from({ length: GUI_PARAMS.numLines }, createLine);
        }

        initializeLines(); // Initial population

        // --- 5. DRAWING FUNCTION ---
        const drawLine = (context, x1, y1, x2, y2, lineWidth, strokeColor) => {
            context.beginPath();
            context.moveTo(x1, y1);
            context.lineTo(x2, y2);
            context.lineWidth = lineWidth;
            context.strokeStyle = strokeColor;
            context.stroke();
        };

        // --- 6. MAIN ANIMATION LOOP ---
        function animate() {
            requestAnimationFrame(animate);
            animationTime += 1 / 60; 

            // 1. Background Clear/Fade Effect
            if (GUI_PARAMS.fadeBackground) {
                ctx.fillStyle = `rgba(0, 0, 0, ${GUI_PARAMS.fadeAlpha})`;
                ctx.fillRect(0, 0, width, height);
            } else {
                ctx.fillStyle = 'black';
                ctx.fillRect(0, 0, width, height);
            }

            const motionFactor = GUI_PARAMS.motionIntensity;
            const currentPreset = GUI_PARAMS.stylePreset;

            // 2. Update and Draw Lines
            lines.forEach(line => {
                const speed = GUI_PARAMS.baseSpeed;

                // Erratic Movement
                const oscillation1 = (Math.sin(animationTime * 2 * motionFactor) * 0.5 + 1);
                const oscillation2 = (Math.cos(animationTime * 2.5 * motionFactor) * 0.5 + 1);

                line.x1 += line.speedX1 * speed * oscillation1;
                line.y1 += line.speedY1 * speed * oscillation1;
                line.x2 += line.speedX2 * speed * oscillation2;
                line.y2 += line.speedY2 * speed * oscillation2;

                // Line Width Morphing
                line.lineWidth = Math.max(1, (line.lineWidth + Math.sin(animationTime * 5 + line.speedX1) * 0.1));
                line.lineWidth = Math.min(line.lineWidth, GUI_PARAMS.maxLineWidth);

                // Boundary Check
                if (line.x1 < 0 || line.x1 > width) line.speedX1 *= -1;
                if (line.y1 < 0 || line.y1 > height) line.speedY1 *= -1;
                if (line.x2 < 0 || line.x2 > width) line.speedX2 *= -1;
                if (line.y2 < 0 || line.y2 > height) line.speedY2 *= -1;

                // Color Flash/Switch: Randomly change color based on the active preset
                if (Math.random() < 0.01) { 
                    line.strokeColor = generateStrokeColor(currentPreset);
                }

                // Draw the line
                drawLine(ctx, line.x1, line.y1, line.x2, line.y2, line.lineWidth, line.strokeColor);
            });
        }

        // --- 7. GUI SETUP ---
        const gui = new dat.GUI();
        
        // Lines Folder
        const linesFolder = gui.addFolder('Lines & Quantity');
        linesFolder.add(GUI_PARAMS, 'numLines', 10, 2000).step(1).name('Line Count').onFinishChange(GUI_PARAMS.init);
        linesFolder.add(GUI_PARAMS, 'maxLineWidth', 1, 20).name('Max Thickness');
        linesFolder.open();

        // Motion Folder
        const motionFolder = gui.addFolder('Motion');
        motionFolder.add(GUI_PARAMS, 'baseSpeed', 0.1, 10).name('Base Speed');
        motionFolder.add(GUI_PARAMS, 'motionIntensity', 0.5, 5).name('Erratic Intensity');
        motionFolder.open();

        // Style Folder (Now Preset-focused)
        const styleFolder = gui.addFolder('Style Presets');
        styleFolder.add(GUI_PARAMS, 'stylePreset', Object.keys(STYLE_PRESETS))
            .name('Style Theme')
            .onFinishChange(GUI_PARAMS.init); // Re-initialize lines to apply new color instantly
        
        styleFolder.add(GUI_PARAMS, 'fadeBackground').name('Enable Trail (Fade)');
        styleFolder.add(GUI_PARAMS, 'fadeAlpha', 0.01, 1).step(0.01).name('Trail Strength');
        styleFolder.open();

        gui.add(GUI_PARAMS, 'init').name('Re-Initialize Lines');
        
        // --- 8. START ---
        animate(); 
    </script>
</body>
</html>